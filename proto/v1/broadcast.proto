syntax = "proto3";
import "proto/v1/packet.proto";

package UDataPacketImport.GRPC.V1;

/*!
 * This broadcasts data read from SEEDLink.  Effectively, what is read is
 * immediately forwarded to the consumers.
 */
service SEEDLinkBroadcast
{
    /// Subscribes to the incoming packets.
    rpc Subscribe(SubscribeToAllStreamsRequest) returns(stream Packet) {};
}

/*!
 * This is a more nuanced broacast for supporting real-time applications.  As
 * such this utility can attempt to suppress wonky data - future, latent,
 * overlapping, and duplicate data. 
 */
service RealTimeBroadcast
{
    /// Gets the currently available streams.
    rpc GetAvailableStreams(AvailableStreamsRequest) returns(AvailableStreamsResponse) {}; 
    /// Subscribes to all incoming streams.
    rpc SubscribeToAllStreams(SubscribeToAllStreamsRequest) returns(stream Packet) {};
    /// Subscribes to a subset of incoming streams.
    rpc Subscribe(SubscriptionRequest) returns(stream Packet) {}; 
}

// Requests the available streams in the broadcast.
message AvailableStreamsRequest
{
}

// The streams that are currently available.
message AvailableStreamsResponse
{
    // The available streams.
    repeated StreamIdentifier stream_identifiers = 1;
}

// Subscribe to a specific set of streams.
message SubscriptionRequest
{
   // The stream identifiers to which to subscribe.  These can be identified with a stream request.
   repeated StreamIdentifier streams = 1;
}

// Subscribes to all available streams.
message SubscribeToAllStreamsRequest
{
}
